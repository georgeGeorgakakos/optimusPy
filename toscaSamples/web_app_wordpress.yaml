tosca_definitions_version: tosca_simple_yaml_1_3
description: WordPress application with MySQL database

topology_template:
  inputs:
    db_password:
      type: string
      description: Database root password
    wp_version:
      type: string
      default: "6.4.2"
  
  node_templates:
    wordpress:
      type: tosca.nodes.WebApplication
      properties:
        version: { get_input: wp_version }
        context_root: /
      requirements:
        - host: webserver
        - database: mysql_db
      capabilities:
        app_endpoint:
          properties:
            protocol: http
            port: 80
    
    webserver:
      type: tosca.nodes.WebServer.Apache
      properties:
        version: "2.4"
      requirements:
        - host: web_host
    
    mysql_db:
      type: tosca.nodes.Database.MySQL
      properties:
        version: "8.0"
        name: wordpress_db
        password: { get_input: db_password }
      requirements:
        - host: db_host
    
    web_host:
      type: tosca.nodes.Compute
      capabilities:
        host:
          properties:
            num_cpus: 2
            mem_size: 4 GB
        os:
          properties:
            architecture: x86_64
            type: linux
            distribution: ubuntu
            version: 22.04
    
    db_host:
      type: tosca.nodes.Compute
      capabilities:
        host:
          properties:
            num_cpus: 4
            mem_size: 8 GB
