tosca_definitions_version: tosca_simple_yaml_1_3
description: Kubernetes StatefulSet for database

topology_template:
  node_templates:
    postgres_statefulset:
      type: tosca.nodes.Kubernetes.StatefulSet
      properties:
        name: postgres
        replicas: 3
        container_image: postgres:16
        volume_claim_template:
          storage: 100Gi
          storage_class: fast-ssd
      requirements:
        - host: k8s_cluster
    
    postgres_service:
      type: tosca.nodes.Kubernetes.Service
      properties:
        name: postgres-service
        type: ClusterIP
        port: 5432
      requirements:
        - statefulset: postgres_statefulset
    
    k8s_cluster:
      type: tosca.nodes.Kubernetes.Cluster
      properties:
        version: "1.28"
